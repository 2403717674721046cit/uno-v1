<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Expense Tracker</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      padding: 20px;
    }

    .box {
      background: white;
      padding: 15px;
      max-width: 400px;
      margin: auto;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    input, button {
      width: 100%;
      padding: 8px;
      margin: 5px 0;
    }

    ul {
      list-style: none;
      padding: 0;
    }

    li {
      background: #eee;
      margin: 5px 0;
      padding: 8px;
      display: flex;
      justify-content: space-between;
    }

    button {
      cursor: pointer;
    }
  </style>
</head>

<body>

<div class="box">
  <h2>Login / Signup</h2>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button onclick="signup()">Sign Up</button>
  <button onclick="login()">Login</button>
  <button onclick="logout()">Logout</button>
</div>

<br>

<div class="box">
  <h2>Add Expense</h2>
  <input id="amount" type="number" placeholder="Amount">
  <input id="category" placeholder="Category">
  <input id="date" type="date">
  <input id="note" placeholder="Note">
  <button onclick="addExpense()">Add Expense</button>
</div>

<br>

<div class="box">
  <h2>Your Expenses</h2>
  <ul id="expenseList"></ul>
</div>

<script type="module">
  // üîπ Firebase imports
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
  import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

  // üîπ Firebase config (REPLACE THIS)
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    projectId: "YOUR_PROJECT_ID"
  };

  // üîπ Init
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // üîπ Signup
  window.signup = async () => {
    await createUserWithEmailAndPassword(auth, email.value, password.value);
    alert("Signed up!");
  };

  // üîπ Login
  window.login = async () => {
    await signInWithEmailAndPassword(auth, email.value, password.value);
    alert("Logged in!");
  };

  // üîπ Logout
  window.logout = async () => {
    await signOut(auth);
    expenseList.innerHTML = "";
  };

  // üîπ Add Expense
  window.addExpense = async () => {
    const user = auth.currentUser;
    if (!user) return alert("Login first");

    await addDoc(collection(db, "users", user.uid, "expenses"), {
      amount: Number(amount.value),
      category: category.value,
      date: date.value,
      note: note.value,
      createdAt: new Date()
    });

    loadExpenses();
  };

  // üîπ Load Expenses
  async function loadExpenses() {
    const user = auth.currentUser;
    if (!user) return;

    const snap = await getDocs(collection(db, "users", user.uid, "expenses"));
    expenseList.innerHTML = "";

    snap.forEach(d => {
      const e = d.data();
      expenseList.innerHTML += `
        <li>
          ‚Çπ${e.amount} - ${e.category}
          <button onclick="deleteExpense('${d.id}')">‚ùå</button>
        </li>
      `;
    });
  }

  // üîπ Delete Expense
  window.deleteExpense = async (id) => {
    const user = auth.currentUser;
    await deleteDoc(doc(db, "users", user.uid, "expenses", id));
    loadExpenses();
  };

  // üîπ Persist Login
  onAuthStateChanged(auth, user => {
    if (user) loadExpenses();
  });
</script>

</body>
</html>
